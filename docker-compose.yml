services:
  # Adhan (prayer times) app: plays adhan and sends Telegram notifications
  adzan-app:
    build:
      context: ./adzan
    environment:
      DISPLAY: "${DISPLAY}"
      PULSE_SERVER: "unix:${XDG_RUNTIME_DIR}/pulse/native"
      TELEGRAM_BOT_TOKEN: "${TELEGRAM_BOT_TOKEN}"
      TELEGRAM_CHAT_ID: "${TELEGRAM_CHAT_ID}"
    devices:
      - "/dev/snd:/dev/snd"
    volumes:
      - "${XDG_RUNTIME_DIR}/pulse/native:${XDG_RUNTIME_DIR}/pulse/native"
      - "/etc/machine-id:/etc/machine-id"
      - "/run/dbus:/run/dbus"
    network_mode: "host"
    privileged: true

  # Telegram bot to test speaker (/bell plays bell.wav)
  audio-bot:
    build:
      context: ./audio
    environment:
      DISPLAY: "${DISPLAY}"
      PULSE_SERVER: "unix:${XDG_RUNTIME_DIR}/pulse/native"
      TELEGRAM_BOT_TOKEN: "${TELEGRAM_BOT_TOKEN}"
    devices:
      - "/dev/snd:/dev/snd"
    volumes:
      - "${XDG_RUNTIME_DIR}/pulse/native:${XDG_RUNTIME_DIR}/pulse/native"
      - "/etc/machine-id:/etc/machine-id"
      - "/run/dbus:/run/dbus"
    network_mode: "host"
    privileged: true
